# Instructions pour GitHub Copilot - PelletsFun

## Contexte du projet
Ce projet est une application de gestion de données de chaudière à pellets avec :
- Backend Node.js/Express avec MongoDB
- Frontend React
- Intégration Gmail API pour import automatique
- Déploiement sur serveur Proxmox

## Instructions de développement

### Architecture
- Respecter la structure 3-sections pliables dans l'interface (Configuration, Import & Traitement, Analyse & Historique)
- Maintenir la persistance des configurations en base de données
- Suivre les patterns établis pour les modèles MongoDB (BoilerConfig, GmailConfig, etc.)

### Bonnes pratiques
- Toujours valider les entrées utilisateur côté backend
- Utiliser les styles CSS existants dans BoilerManagerRestructured.css
- Maintenir la cohérence des messages d'erreur et de succès
- Logger les opérations importantes avec des emojis pour faciliter le debugging

### Gestion des données
- Éviter la duplication de données en MongoDB (optimisation quota)
- Implémenter la suppression en cascade pour maintenir l'intégrité
- Utiliser les agrégations MongoDB pour les statistiques
- Maintenir l'historique des imports avec catégorisation temporelle

### Interface utilisateur
- Utiliser les composants pliables existants
- Maintenir l'accessibilité (focus states, ARIA labels)
- Responsive design obligatoire
- Confirmations utilisateur pour les actions destructives

### Configuration Gmail
- Centraliser toute la configuration Gmail dans GmailConfig
- Supporter les multi-expéditeurs via le tableau senders
- Gérer la migration automatique des anciennes configurations
- Maintenir la compatibilité OAuth2 avec refresh tokens

## Processus de version et déploiement

### À la fin de chaque développement d'évolution
**OBLIGATOIRE** : Proposer un git add + git commit avec un message en français approprié.

Format des commandes recommandé :
```bash
git add .
git commit -m "feat: Description concise de l'évolution

- Point clé 1 en français
- Point clé 2 en français  
- Point clé 3 en français"
```

Exemples de messages de commit :
- `feat: Ajout suppression imports et catégorisation historique`
- `fix: Correction filtrage intervalle d'import des données CSV`
- `refactor: Centralisation gestion configuration Gmail`
- `style: Amélioration design responsive mobile`

### Structure des messages de commit
- Utiliser les préfixes conventionnels : `feat:`, `fix:`, `refactor:`, `style:`, `docs:`
- Description courte en français (première ligne)
- Détails en français avec tirets (lignes suivantes)
- Mentionner les breaking changes si applicable

### Déploiement manuel
Après le commit, l'utilisateur exécutera manuellement le script de déploiement :
```bash
./deploy-local.sh "Message du commit"
```

### Tests avant déploiement
- Vérifier le build frontend (`npm run build`)
- Tester les nouvelles fonctionnalités localement
- Vérifier les logs backend pour les erreurs
- Valider l'interface sur différentes tailles d'écran

## Maintenance et debugging
- Utiliser `pm2 logs pelletsfun-backend` pour les logs
- Surveiller l'utilisation MongoDB Atlas (quota 512MB)
- Vérifier les certificats SSL et la configuration Nginx
- Maintenir la documentation des nouvelles fonctionnalités